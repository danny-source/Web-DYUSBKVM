# CH9329 芯片串口通信協議

**版本：** V1.3  
**來源：** https://wch.cn
**整理：** DA2@Danny https://da2.35g.tw

---

## 目錄

1. [通信模式](#通信模式)
2. [通信結構](#通信結構)
3. [通信方法](#通信方法)
4. [幀格式說明](#幀格式說明)
5. [命令碼說明](#命令碼說明)
6. [鍵碼表](#鍵碼表)
7. [錯誤應答包](#錯誤應答包)

---

## 通信模式

CH9329 芯片支持 3 種串口通信模式：

- **模式 0：協議傳輸模式（默認）**
- **模式 1：ASCII 模式**
- **模式 2：透明傳輸模式**

本文檔主要描述模式 0 的協議。

---

## 通信結構

```
外圍串口設備（PC、MCU等） ←→ 串口 ←→ CH9329 芯片 ←→ USB ←→ USB 主機（PC、平板等）
```

CH9329 芯片作為串口與 USB 之間的橋樑。

---

## 通信方法

- **主從模式**：外圍串口設備為主，CH9329 芯片為從
- **命令發起**：由外圍串口設備發起，CH9329 芯片被動響應
- **超時時間**：500ms（如果外圍串口設備在 500ms 內未收到響應或收到錯誤響應，則認為通信失敗）

---

## 幀格式說明

### 基本結構

通信以**幀**（數據包）為單位進行。

| 字段名稱 | 英文名稱 | 大小（字節） | 說明 |
|---------|---------|------------|------|
| 幀頭 | HEAD | 2 | 固定值：`0x57, 0xAB` |
| 地址碼 | ADDR | 1 | 默認值：`0x00`（可配置） |
| 命令碼 | CMD | 1 | 命令類型 |
| 後續數據長度 | LEN | 1 或 2 | 數據長度（CH9329F 支持 2 字節） |
| 後續數據 | DATA | N | 實際數據（0-64 字節，CH9329F 支持 0-512 字節） |
| 累加和 | SUM | 1 | 校驗和 |

### 地址碼（ADDR）

- **0x00**：默認值，芯片可接收任意地址碼的命令
- **0x01-0xFE**：如果芯片地址設置為此範圍，則只接受該地址碼或 `0xFF` 的命令
- **0xFF**：廣播地址，芯片不需要響應廣播包

### 命令碼（CMD）

- **0x01-0x3F**：外圍串口設備發起的命令碼
- **正常響應**：原命令碼 `| 0x80`（例如：0x01 → 0x81）
- **異常響應**：原命令碼 `| 0xC0`（例如：0x01 → 0xC1）

### 校驗和（SUM）

計算公式：`SUM = HEAD + ADDR + CMD + LEN + DATA`（所有字節的總和 mod 256）

---

## 命令碼說明

### 表 1 - 命令碼表

| 命令名稱 | 命令碼 | 說明 |
|---------|--------|------|
| CMD_GET_INFO | 0x01 | 獲取芯片版本等信息 |
| CMD_SEND_KB_GENERAL_DATA | 0x02 | 發送 USB 鍵盤普通數據 |
| CMD_SEND_KB_MEDIA_DATA | 0x03 | 發送 USB 鍵盤多媒體數據 |
| CMD_SEND_MS_ABS_DATA | 0x04 | 發送 USB 絕對滑鼠數據 |
| CMD_SEND_MS_REL_DATA | 0x05 | 發送 USB 相對滑鼠數據 |
| CMD_SEND_MY_HID_DATA | 0x06 | 發送 USB 自定義 HID 設備數據 |
| CMD_READ_MY_HID_DATA | 0x87 | 讀取 USB 自定義 HID 設備數據 |
| CMD_GET_PARA_CFG | 0x08 | 獲取參數配置 |
| CMD_SET_PARA_CFG | 0x09 | 設置參數配置 |
| CMD_GET_USB_STRING | 0x0A | 獲取字符串描述符配置 |
| CMD_SET_USB_STRING | 0x0B | 設置字符串描述符配置 |
| CMD_SET_DEFAULT_CFG | 0x0C | 恢復出廠默認配置 |
| CMD_RESET | 0x0F | 復位芯片 |
| CMD_SEND_MY_HID_DATA2 | 0x10 | 發送 USB 自定義 HID 設備數據（CH9329F 擴展，支持 2 字節長度） |
| CMD_READ_MY_HID_DATA2 | 0x91 | 讀取 USB 自定義 HID 設備數據（CH9329F 擴展） |
| CMD_GPIO_CONTROL | 0x12 | GPIO 控制命令（CH9329F 擴展） |
| CMD_GET_SP_PARA_CFG | 0x13 | 獲取特殊參數配置（CH9329F 擴展） |
| CMD_SET_SP_PARA_CFG | 0x14 | 設置特殊參數配置（CH9329F 擴展） |
| CMD_JUMP_TO_IAP | 0x15 | 控制芯片進入 IAP 升級模式（CH9329F 擴展） |
| CMD_SEND_TP_DATA | 0x16 | 發送 USB 多點觸摸屏數據（CH9329F 擴展） |

---

## 詳細命令說明

### 2.2.1 CMD_GET_INFO (0x01)

**功能：** 獲取芯片版本、USB 枚舉狀態、鍵盤指示燈狀態等信息。

**外圍串口設備 → 芯片：**
- CMD: `0x01`
- LEN: `0x00`（無參數）

**芯片 → 外圍串口設備：**
- CMD: `0x81`
- LEN: `0x08`（8 字節數據）

**返回數據（8 字節）：**
1. 芯片版本號（0x30=V1.0, 0x31=V1.1...）
2. USB 枚舉狀態（0x00=未連接/未識別, 0x01=已連接並識別成功）
3. 鍵盤指示燈狀態（BIT0=NUM LOCK, BIT1=CAPS LOCK, BIT2=SCROLL LOCK）
4. 計算機睡眠狀態（0x03=睡眠模式，其他=非睡眠）
5-8. 保留（4 字節）

---

### 2.2.2 CMD_SEND_KB_GENERAL_DATA (0x02)

**功能：** 發送 USB 鍵盤普通數據包，模擬按鍵按下或釋放動作。支持全鍵盤和組合鍵操作，可處理 8+6 無衝突按鍵：
- **8 個控制鍵**：左 Ctrl、右 Ctrl、左 Shift、右 Shift、左 Windows、右 Windows、左 Alt、右 Alt
- **6 個普通鍵**：除 8 個控制鍵外的任意 6 個鍵

**外圍串口設備 → 芯片：**
- CMD: `0x02`
- LEN: `0x08`（8 字節數據）

**數據格式（8 字節）：**
1. **控制鍵位**（BIT0=Left Ctrl, BIT1=Left Shift, BIT2=Left Alt, BIT3=Left Win, BIT4=Right Ctrl, BIT5=Right Shift, BIT6=Right Alt, BIT7=Right Win）
2. **固定值**：`0x00`
3-8. **普通鍵值**（最多 6 個 HID Key Code，HID Page 0x07）

**芯片 → 外圍串口設備：**
- CMD: `0x82`
- LEN: `0x01`（1 字節狀態）

**示例：模擬按下 "A" 鍵**
```
0x57, 0xAB, 0x00, 0x02, 0x08, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10
```

**示例：模擬按下 "Left Shift" + "A" 鍵**
```
0x57, 0xAB, 0x00, 0x02, 0x08, 0x02, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12
```

---

### 2.2.3 CMD_SEND_KB_MEDIA_DATA (0x03)

**功能：** 發送 USB 鍵盤多媒體數據包，模擬多媒體鍵按下或釋放動作。

**外圍串口設備 → 芯片：**
- CMD: `0x03`
- LEN: `0x02`（2 字節數據，USB 鍵盤多媒體鍵值）

**芯片 → 外圍串口設備：**
- CMD: `0x83`
- LEN: `0x01`（1 字節狀態）

**多媒體鍵值：** 參考協議文檔附錄 1

---

### 2.2.4 CMD_SEND_MS_ABS_DATA (0x04)

**功能：** 發送 USB 絕對滑鼠數據包，模擬絕對滑鼠相關動作（包括左中右鍵按下與釋放、滾輪上下滾動、上下左右移動）。

**外圍串口設備 → 芯片：**
- CMD: `0x04`
- LEN: `0x07`（7 字節數據）

**數據格式（7 字節）：**
1. **固定值**：`0x02`
2. **按鍵狀態**（BIT0=左鍵, BIT1=右鍵, BIT2=中鍵）
3-4. **X 座標值**（little-endian，低字節在前，範圍 0-4096）
5-6. **Y 座標值**（little-endian，低字節在前，範圍 0-4096）
7. **滾輪**（0=無滾動，0x01-0x7F=向上，0x81-0xFF=向下）

**芯片 → 外圍串口設備：**
- CMD: `0x84`
- LEN: `0x01`（1 字節狀態）

**注意：**
- CH9329 芯片默認模擬的絕對滑鼠解析度為 `4096 * 4096`
- 外圍串口設備發送 XY 絕對值時，必須先根據自身螢幕解析度計算後再傳輸
- **計算公式**：`X_Cur = (4096 * X_Target) / X_MAX`，`Y_Cur = (4096 * Y_Target) / Y_MAX`

**示例：移動到 (100, 100) 位置（螢幕解析度 1280x768）**
- 計算：`X1 = (100 * 4096) / 1280 = 320 = 0x140`，`Y1 = (100 * 4096) / 768 = 533 = 0x215`
- 命令包：`0x57, 0xAB, 0x00, 0x04, 0x07, 0x02, 0x00, 0x40, 0x01, 0x15, 0x02, 0x00, 0x67`

**示例：按下左鍵**
```
0x57, 0xAB, 0x00, 0x04, 0x07, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10
```

**示例：釋放左鍵**
```
0x57, 0xAB, 0x00, 0x04, 0x07, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F
```

---

### 2.2.5 CMD_SEND_MS_REL_DATA (0x05)

**功能：** 發送 USB 相對滑鼠數據包，模擬相對滑鼠相關動作（包括左中右鍵按下與釋放、滾輪上下滾動、上下左右移動）。

**外圍串口設備 → 芯片：**
- CMD: `0x05`
- LEN: `0x05`（5 字節數據）

**數據格式（5 字節）：**
1. **固定值**：`0x01`
2. **按鍵狀態**（BIT0=左鍵, BIT1=右鍵, BIT2=中鍵）
3. **X 方向移動距離**（有符號字節：0x01-0x7F=向右，0x80-0xFF=向左）
4. **Y 方向移動距離**（有符號字節：0x01-0x7F=向下，0x80-0xFF=向上）
5. **滾輪**（0=無滾動，0x01-0x7F=向上，0x81-0xFF=向下）

**芯片 → 外圍串口設備：**
- CMD: `0x85`
- LEN: `0x01`（1 字節狀態）

**示例：按下左鍵**
```
0x57, 0xAB, 0x00, 0x05, 0x05, 0x01, 0x01, 0x00, 0x00, 0x00, 0x0E
```

**示例：釋放左鍵**
```
0x57, 0xAB, 0x00, 0x05, 0x05, 0x01, 0x00, 0x00, 0x00, 0x00, 0x0D
```

**示例：向左移動 3 像素，向下移動 5 像素**
- 向左：`0x57, 0xAB, 0x00, 0x05, 0x05, 0x01, 0x00, 0xFD, 0x00, 0x00, 0x0A`
- 向下：`0x57, 0xAB, 0x00, 0x05, 0x05, 0x01, 0x00, 0x00, 0x05, 0x00, 0x12`

---

### 2.2.6 CMD_SEND_MY_HID_DATA (0x06)

**功能：** 發送 USB 自定義 HID 類設備數據包。

**外圍串口設備 → 芯片：**
- CMD: `0x06`
- LEN: `N`（CH9329: 0-63 字節，CH9329F: 0-127 字節）

**芯片 → 外圍串口設備：**
- CMD: `0x86`
- LEN: `0x01`（1 字節狀態）

---

### 2.2.7 CMD_READ_MY_HID_DATA (0x87)

**功能：** 從芯片讀取 USB 自定義 HID 類設備數據包。PC 機向芯片下傳 1 包自定義 HID 數據包後，由芯片串口自動打包發送給外圍串口設備。

**芯片 → 外圍串口設備：**
- CMD: `0x87`
- LEN: `N`（CH9329: 0-63 字節，CH9329F: 0-127 字節）

**注意：** 此命令由芯片主動發送給外圍串口設備，外圍串口設備不需要響應。

---

### 2.2.8 CMD_GET_PARA_CFG (0x08)

**功能：** 從芯片獲取當前參數配置信息。

**外圍串口設備 → 芯片：**
- CMD: `0x08`
- LEN: `0x00`（無參數）

**芯片 → 外圍串口設備：**
- CMD: `0x88`
- LEN: `0x32`（50 字節數據）

**返回數據（50 字節）：**
1. 芯片工作模式（1 字節）
2. 芯片串口通信模式（1 字節）
3. 芯片串口通信地址（1 字節）
4. 芯片串口通信波特率（4 字節，高字節在前）
5. 保留（2 字節）
6. 芯片串口通信包間隔（2 字節，單位：mS）
7. 芯片 USB 的 VID 和 PID（4 字節）
8. 芯片 USB 鍵盤上傳時間間隔（2 字節，僅 ASCII 模式有效）
9. 芯片 USB 鍵盤釋放延時時間（2 字節，僅 ASCII 模式有效）
10. 芯片 USB 鍵盤自動回車標誌（1 字節，僅 ASCII 模式有效）
11. 芯片 USB 鍵盤回車符（8 字節，僅 ASCII 模式有效）
12. 芯片 USB 鍵盤過濾開始、結束字符串（8 字節，僅 ASCII 模式有效）
13. USB 字符串描述符使能標誌（1 字節）
14. USB 鍵盤快速上傳標誌（1 字節，僅 ASCII 模式有效）
15. 保留（12 字節，CH9329F 有特殊功能）

---

### 2.2.9 CMD_SET_PARA_CFG (0x09)

**功能：** 向芯片設置當前參數配置信息。

**外圍串口設備 → 芯片：**
- CMD: `0x09`
- LEN: `0x32`（50 字節數據，格式同 CMD_GET_PARA_CFG 返回數據）

**芯片 → 外圍串口設備：**
- CMD: `0x89`
- LEN: `0x01`（1 字節狀態）

**注意：** 所有參數設置在下次上電後生效。

---

### 2.2.10 CMD_GET_USB_STRING (0x0A)

**功能：** 從芯片獲取當前使用的 USB 字符串描述符配置。

**外圍串口設備 → 芯片：**
- CMD: `0x0A`
- LEN: `0x01`（1 字節參數：0x00=製造商, 0x01=產品, 0x02=序列號）

**芯片 → 外圍串口設備：**
- CMD: `0x8A`
- LEN: `2+N`（2+N 字節數據）

**返回數據：**
1. 字符串類型（1 字節）
2. 字符串長度（1 字節，有效範圍 0-23）
3. 字符串內容（N 字節，有效範圍 1-23）

---

### 2.2.11 CMD_SET_USB_STRING (0x0B)

**功能：** 向芯片設置當前使用的 USB 字符串描述符配置。

**外圍串口設備 → 芯片：**
- CMD: `0x0B`
- LEN: `2+N`（2+N 字節數據）

**數據格式：**
1. 字符串類型（1 字節：0x00=製造商, 0x01=產品, 0x02=序列號）
2. 字符串長度（1 字節，有效範圍 0-23）
3. 字符串內容（N 字節，有效範圍 1-23）

**芯片 → 外圍串口設備：**
- CMD: `0x8B`
- LEN: `0x01`（1 字節狀態）

---

### 2.2.12 CMD_SET_DEFAULT_CFG (0x0C)

**功能：** 將芯片的參數配置及字符串配置信息恢復到出廠默認設置。

**外圍串口設備 → 芯片：**
- CMD: `0x0C`
- LEN: `0x00`（無參數）

---

### 2.2.13 CMD_RESET (0x0F)

**功能：** 控制芯片進行軟件復位。

**外圍串口設備 → 芯片：**
- CMD: `0x0F`
- LEN: `0x00`（無參數）

**芯片 → 外圍串口設備：**
- CMD: `0x8F`
- LEN: `0x01`（1 字節狀態）

---

### 2.2.14 CMD_SEND_MY_HID_DATA2 (0x10) - CH9329F 擴展

**功能：** 發送 USB 自定義 HID 類設備數據包（支持 2 字節長度）。

**外圍串口設備 → 芯片：**
- CMD: `0x10`
- LEN: `2 字節`（高字節在前，支持 0-510 字節數據）

**芯片 → 外圍串口設備：**
- CMD: `0x90`
- LEN: `0x01`（1 字節狀態）

---

### 2.2.15 CMD_READ_MY_HID_DATA2 (0x91) - CH9329F 擴展

**功能：** 從芯片讀取 USB 自定義 HID 類設備數據包（支持 2 字節長度）。

**芯片 → 外圍串口設備：**
- CMD: `0x91`
- LEN: `2 字節`（高字節在前，支持 0-510 字節數據）

**注意：** 此命令由芯片主動發送，外圍串口設備不需要響應。

---

### 2.2.16 CMD_GPIO_CONTROL (0x12) - CH9329F 擴展

**功能：** 控制芯片的 GPIO 引腳。

**外圍串口設備 → 芯片：**
- CMD: `0x12`
- LEN: `0x01`（1 字節）
- DATA: `3 字節數據`
  - 子命令字（0x00=讀取狀態, 0x01=設置使能, 0x02=設置方向, 0x03=設置輸出電平）
  - 操作參數（2 字節）

**芯片 → 外圍串口設備：**
- CMD: `0x92`
- LEN: `0x01`（1 字節）
- DATA: `4 字節數據`（狀態信息）

---

### 2.2.17 CMD_GET_SP_PARA_CFG (0x13) - CH9329F 擴展

**功能：** 從芯片獲取特殊參數配置信息。

**外圍串口設備 → 芯片：**
- CMD: `0x13`
- LEN: `0x00`（無參數）

**芯片 → 外圍串口設備：**
- CMD: `0x93`
- LEN: `0x0A`（10 字節數據）

**返回數據（10 字節）：**
1. 芯片睡眠禁用標誌（1 字節）
2. 芯片 USB 接口速度設置標誌（1 字節）
3. 芯片 USB 觸摸屏模式使能標誌（1 字節）
4. HID 自定義設備端點下行數據作為串口命令包功能使能標誌（1 字節）
5. USB 鍵盤/滑鼠數據包立即響應標誌（1 字節）
6-10. 保留（5 字節）

---

### 2.2.18 CMD_SET_SP_PARA_CFG (0x14) - CH9329F 擴展

**功能：** 向芯片臨時設置特殊參數配置信息（掉電不保存）。

**外圍串口設備 → 芯片：**
- CMD: `0x14`
- LEN: `0x0A`（10 字節數據，格式同 CMD_GET_SP_PARA_CFG）

**芯片 → 外圍串口設備：**
- CMD: `0x94`
- LEN: `0x01`（1 字節狀態）

---

### 2.2.19 CMD_JUMP_TO_IAP (0x15) - CH9329F 擴展

**功能：** 控制芯片跳轉進入 IAP 升級模式。

---

### 2.2.20 CMD_SEND_TP_DATA (0x16) - CH9329F 擴展

**功能：** 發送 USB 多點觸摸屏數據包。

**外圍串口設備 → 芯片：**
- CMD: `0x16`
- LEN: `0x34`（52 字節數據）

**數據格式（52 字節）：**
1. Report ID：`0x01`（固定）
2-9. 第 1 組觸摸點數據（8 字節）
   - 觸摸點按下或釋放狀態（1 字節：0x00=釋放, 0x01=按下）
   - 觸摸點編號（1 字節）
   - X 軸座標值（2 字節，little-endian）
   - Y 軸座標值（2 字節，little-endian）
   - 觸摸點時間軸偏移（2 字節）
10-17. 第 2 組觸摸點數據（8 字節）
18-25. 第 3 組觸摸點數據（8 字節）
26-33. 第 4 組觸摸點數據（8 字節）
34-41. 第 5 組觸摸點數據（8 字節）
42-49. 第 6 組觸摸點數據（8 字節）
50-51. 固定值：`0x01, 0x01`
52. 觸摸點有效個數（1 字節，範圍 0x01-0x06）

**芯片 → 外圍串口設備：**
- CMD: `0x96`
- LEN: `0x01`（1 字節狀態）

---

## 錯誤應答包

當芯片接收到命令包的命令碼錯誤、校驗和錯誤或執行失敗時，會返回錯誤應答包。

**錯誤應答包結構：**
- CMD: 原命令碼 `| 0xC0`
- LEN: `0x01`（1 字節狀態）

### 表 2 - 命令執行狀態

| 狀態名稱 | 狀態碼 | 狀態說明 |
|---------|--------|---------|
| DEF_CMD_SUCCESS | 0x00 | 命令執行成功 |
| DEF_CMD_ERR_TIMEOUT | 0xE1 | 串口接收一個字節超時 |
| DEF_CMD_ERR_HEAD | 0xE2 | 串口接收包頭字節出錯 |
| DEF_CMD_ERR_CMD | 0xE3 | 串口接收命令碼錯誤 |
| DEF_CMD_ERR_SUM | 0xE4 | 累加和檢驗值不匹配 |
| DEF_CMD_ERR_PARA | 0xE5 | 參數錯誤 |
| DEF_CMD_ERR_OPERATE | 0xE6 | 幀正常，執行失敗 |

---

## 鍵碼表

### 附錄 1 - CH9329 鍵碼表

#### 普通按鍵及對應的鍵碼表（HID Page 0x07）

| 符號 | HID Code | 符號 | HID Code |
|------|----------|------|----------|
| a, A | 0x04 | b, B | 0x05 |
| c, C | 0x06 | d, D | 0x07 |
| e, E | 0x08 | f, F | 0x09 |
| g, G | 0x0A | h, H | 0x0B |
| i, I | 0x0C | j, J | 0x0D |
| k, K | 0x0E | l, L | 0x0F |
| m, M | 0x10 | n, N | 0x11 |
| o, O | 0x12 | p, P | 0x13 |
| q, Q | 0x14 | r, R | 0x15 |
| s, S | 0x16 | t, T | 0x17 |
| u, U | 0x18 | v, V | 0x19 |
| w, W | 0x1A | x, X | 0x1B |
| y, Y | 0x1C | z, Z | 0x1D |
| 1, ! | 0x1E | 2, @ | 0x1F |
| 3, # | 0x20 | 4, $ | 0x21 |
| 5, % | 0x22 | 6, ^ | 0x23 |
| 7, & | 0x24 | 8, * | 0x25 |
| 9, ( | 0x26 | 0, ) | 0x27 |
| Enter | 0x28 | Escape | 0x29 |
| Backspace | 0x2A | Tab | 0x2B |
| Space | 0x2C | - | 0x2D |
| = | 0x2E | [ | 0x2F |
| ] | 0x30 | \ | 0x31 |
| ; | 0x33 | ' | 0x34 |
| ` | 0x35 | , | 0x36 |
| . | 0x37 | / | 0x38 |
| Caps Lock | 0x39 | F1 | 0x3A |
| F2 | 0x3B | F3 | 0x3C |
| F4 | 0x3D | F5 | 0x3E |
| F6 | 0x3F | F7 | 0x40 |
| F8 | 0x41 | F9 | 0x42 |
| F10 | 0x43 | F11 | 0x44 |
| F12 | 0x45 | Print Screen | 0x46 |
| Scroll Lock | 0x47 | Pause | 0x48 |
| Insert | 0x49 | Home | 0x4A |
| Page Up | 0x4B | Delete | 0x4C |
| End | 0x4D | Page Down | 0x4E |
| → | 0x4F | ← | 0x50 |
| ↓ | 0x51 | ↑ | 0x52 |
| Num Lock | 0x53 | Numpad / | 0x54 |
| Numpad * | 0x55 | Numpad - | 0x56 |
| Numpad + | 0x57 | Numpad Enter | 0x58 |
| Numpad 1 | 0x59 | Numpad 2 | 0x5A |
| Numpad 3 | 0x5B | Numpad 4 | 0x5C |
| Numpad 5 | 0x5D | Numpad 6 | 0x5E |
| Numpad 7 | 0x5F | Numpad 8 | 0x60 |
| Numpad 9 | 0x61 | Numpad 0 | 0x62 |
| Numpad . | 0x63 | | |

#### 修飾鍵（HID Page 0x07）

| 鍵名 | HID Code |
|------|----------|
| Left Ctrl | 0xE0 |
| Left Shift | 0xE1 |
| Left Alt | 0xE2 |
| Left Win | 0xE3 |
| Right Ctrl | 0xE4 |
| Right Shift | 0xE5 |
| Right Alt | 0xE6 |
| Right Win | 0xE7 |
| Context Menu | 0x65 |

#### 多媒體鍵

**ACPI 鍵（HID Page 0x01）：**
- Power: 0x81
- Sleep: 0x82
- Wake-up: 0x83

**其他多媒體鍵：** 參考協議文檔附錄 1

---

## 注意事項

1. **數據格式**：文檔中所有數據均為十六進制格式（16 進制）
2. **超時處理**：如果外圍串口設備在 500ms 內未收到響應或收到錯誤響應，應進行重試或錯誤處理
3. **命令包和應答包**：外圍串口設備發起的通信幀稱為「命令包」，芯片返回的通信幀稱為「應答包」
4. **錯誤處理**：芯片接收到錯誤幀時，會返回錯誤響應幀或直接丟棄該幀
5. **座標映射**：絕對滑鼠座標需要根據實際螢幕解析度映射到 0-4096 範圍
6. **滾輪處理**：滾輪值 0x01-0x7F 表示向上滾動，0x81-0xFF 表示向下滾動

---

## 參考資料

- **官方文檔**：CH9329 芯片串口通信協議 V1.3
- **官方網站**：https://wch.cn
- **芯片型號**：CH9329 / CH9329F（擴展功能）

---

**文檔版本：** V1.3  
**最後更新：** 根據 CH9329 協議文檔整理

